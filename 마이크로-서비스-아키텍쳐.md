## 목적
* 모놀리틱 아키텍쳐와 마이크로 서비스 아키텍쳐를 비교하고, 각각의 장단점을 이해한다.
* 마이크로 서비스 아키텍쳐에서 API를 통합 관리하는 API 게이트웨이의 개념을 이해한다.

## 모놀리틱 아키텍쳐
![모놀리틱 아키텍쳐](http://guruble.com/wp-content/uploads/2016/08/1.png)
#### 장점
* 로컬 환경에서 개발하기에도 편리함, 통합 시나리오 테스트를 수행하기에도 가장 손쉬운 구성임 또한 모든 코드가 하나의 묶음으로 구성되어 있기 때문에 배포도 매우 간편해짐
#### 단점
* 조직 규모의 증가할수록 애플리케이션의 규모와 복잡도가 증가함, 작은 기능 변화에도 사이드 이펙트가 없는지 통합 테스트가 필요하며 이에 따라 개발 / 빌드 / 배포의 속도가 느려짐

## 마이크로 아키텍쳐
![마이크로 아키텍쳐](http://guruble.com/wp-content/uploads/2016/08/2.png)
#### 기본 개념
* 독립적인 역할을 할 수 있는 비즈니스 컴포넌트 또는 모듈 단위로 서비스를 분리하여 설계 / 구현하는 아키텍쳐
* 각 서비스 간 통신은 Restfull API로 통신하며 API 게이트웨이를 통해 API 인증, 인가, URI 및 메소드에 따른 라우팅 기능을 통합 관리함
#### 장점
* 비즈니스 컴포넌트 또는 모듈 단위의 최적화된 서버 인프라를 활용 및 구축 가능
* 서비스의 각 모듈별 독립적인 설계 구축을 통해 개발 간 사이드 이펙트를 최소화함으로써 개발을 보다 효율적으로 할 수 있음
#### 단점
* 서비스의 운영 및 네트워크에 의존적인 상황이 되기 쉬움. 가령 예를 들어 사용자의 요청을 받은 A 서비스가 B,C,D 서비스를 통해 데이터를 받을 때 B,C,D 서비스의 운영 및 네트워크 상황에 따라 서비스 전면 장애가 나지 않도록 처리해야 되는 것을 고민해야 함
* 백엔드에서 동시 요청이 과다하게 발생할 수 있음. 가령 A,B,C 서비스가 하나의 웹 화면에 노출되고, D 라는 데이터 베이스를 쓸 때 A,B,C 서비스의 동시 요청이 한번에 들어오는 수가 들어오면서 급격한 로드 에버리지가 올라가면서 서비스 전면 장애가 발생할 수 있음
* 마이크로 서비스 역시 고도화 될 수록 API의 파편화가 발생할 수 있기 때문에 개발에 대한 의존성이 증가하며 배포의 어려움이 발생할 수 있음
  - 쿠팡의 경우 급격한 비즈니스의 성장에 따라 마이크로 서비스 아키텍쳐 과도기일 때 각 팀에 배포 깃발을 이용해서 배포 깃발을 올린 팀만 배포를 할 수 있었다고 함
  - 쿠팡의 사례를 한가지 더 들면 각 팀별로 개발 언어 및 API의 파편화가 이뤄나 이에 대한 동기화를 맞추는 작업에 많은 에너지가 소요된사례가 있음
* 프론트엔드에서 여러개의 서비스를 요청하고, 각 요청에 대해 콜백처리를 해야 되는데 각각의 콜백들에 대한 예외 처리를 하다보면 코드 자체의 품질이 매우 떨어질 수 있음

## API 게이트웨이

#### API 인증/인가
![인증/인가](https://t1.daumcdn.net/cfile/tistory/21624D3C54F323CB23) 
* API 게이트웨이의 가장 기본적인 기능은 API 에 대한 인증과 인가 관련 기능, 인증은 API 를 호출하는 클라이언트에 대한 identity(신분)를 확인 해주는 기능이고, 인가는 클라이언트가 API를 호출할 수 있는 권한이 있는지를 확인해주는 기능으로써 이 2개를 통합 관리함으로써 API에 대한 기본적인 통합 관리가 이루어짐

#### API 엔드포인트
![API 엔드포인트](https://t1.daumcdn.net/cfile/tistory/265A9C3C54F323CB2B)
* 토큰 파싱 후 인증 및 인가 정보를 확인 후 요청에 대한 리소스 응답 처리

#### API 공통 로직
![공통 로직 처리](https://t1.daumcdn.net/cfile/tistory/235AD43C54F323CC2B)
#### API 게이트웨이는 특성상 모든 API 서버 앞쪽에 위치 하기 때문에, 모든 API 호출이 이 API 게이트를 거쳐간다. 그렇기 때문에, 모든 API 가 공통적으로 처리해야 하는 공통 기능이 필요할 경우 이러한 공통 기능을 API 게이트웨이로 옮기게 되면 별도로 API 서버에서 이러한 기능을 개발할 필요 없이 비지니스 로직 자체 구현에만 집중

#### API 어그리에이션
![API 어그리에이션](https://t1.daumcdn.net/cfile/tistory/216DB03C54F323CB16)
여러개의 API를 묶어서 하나의 API로 만드는 작업을 이야기 한다. 예를 들어 계좌 이체를 한다고 했을때, A은행에서 잔액 확인 -> A은행에서 인출 -> B은행으로 입금하는 3개의 API 호출을 하나의 API 인 POST transfer(인출계좌,입급계좌,금액)으로 구현함



